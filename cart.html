<!DOCTYPE html>
<html>
	<head>
		<title>Cart:E-Commerce</title>
		<meta name="viewport" content="width=device-width, initial-scale=1">
	</head>
	<body>
		<header>
			| <a href="home">Home</a> | <a href="chat">Chat</a> | <a href="cart">Cart (<span id="productsCountInCart"></span>)</a>
		</header>
		<h1>Cart</h1>
		<table border="1">
			<thead>
				<th>#</th>
				<th>Code</th>
				<th>Name</th>
				<th>Price</th>
				<th>Quantity</th>
				<th>Total</th>
			</thead>
			<tbody id="products">

			</tbody>
			<tfoot>
				<th colspan="4"></td>
				<th>Grand Total:</td>
				<th id="grandTotal" style="text-align: right;"></td>
			</tfoot>
		</table>

		<script src="js/e-commerce.js" type="text/javascript"></script>
		<script src="https://unpkg.com/realm-web@1.5.1/dist/bundle.iife.js"></script>
		<script>
			document.addEventListener("DOMContentLoaded", function(event) { 
				//do work
				console.log('DOMContentLoaded');
				countProductInCart();
				getProductInCart();
			});

			function getProductInCart(){
				var listProduct = getItemInLocalStorage('cart');
				if(listProduct!=null){
						var products = '';
						var grandTotal = 0;
						for(var i=0;i<listProduct.length;i++){
							products += '<tr>'
							+'<td>'+'<img src="/files/'+listProduct[i].path+'" style="width:180px">'+ '</td>' 
							+'<td>'+ listProduct[i].code + '</td>' 					
							+'<td>'+ listProduct[i].name + '</td>' 
							+'<td>'+ listProduct[i].price + '</td>' 
							+'<td>'+ listProduct[i].qty + '</td>' 
							+'<td>'+ listProduct[i].total + '</td>'				
							+ '</tr>';
							grandTotal +=parseFloat(listProduct[i].total);
						}
						document.getElementById('products').innerHTML = products;
						document.getElementById('grandTotal').innerText = grandTotal;
				}
			}
			
		</script>
	</body>
</html> 